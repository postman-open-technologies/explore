---
layout: default
title: Admin - Blueprints
---

<div class="container" style="padding-top: 70px;">
	<div class="row align-top">
		<div class="row">
			<script>
				function changeToken(t){
					Cookies.set('token',t)
				}
			</script>
			<div class="col">				
				<input type="text" class="form-control" id="token" name="token" value="{{ site.token }}" placeholder="Token" onchange="changeToken();">
			</div>
			<div class="col-2">				
				<input type="text" class="form-control" id="search" name="search" value="" placeholder="Search">
			</div>	
			<div class="col-2">				
				<input type="text" class="form-control" id="tags" name="tags" value="" placeholder="tag,tag,tag">
			</div>	
			<div class="col-1">				
				<select class="form-control" id="role"></select>
			</div>							
			<label for="page" class="col-sm-2 col-form-label" style="text-align:right; width: 50px;">Page:</label>
			<div class="col">				
				<input type="text" class="form-control" id="page" name="page" value="0" style="text-align: center;">
			</div>	
			<label for="limit" class="col-sm-2 col-form-label" style="text-align:right; width: 50px;">Limit:</label>
			<div class="col">				
				<input type="text" class="form-control" id="limit" name="limit" value="10" style="text-align: center;">
			</div>								
			<div class="col">
				<input type="button" class="btn btn-primary" name="listblueprints" id="listblueprints" value="Search" onclick="listBlueprints();">
			</div>
			<div class="col">
				<input type="button" class="btn btn-success" name="show" value="Add" onclick="openAddBueprintModal();">
			</div>			
		</div>								
		<script>

			var search = getUrlVar('search');
			document.getElementById('search').value = search;

			var token = getUrlVar('token');				
			if(token){
				document.getElementById('token').value = token;		
				changeToken(token);
			}

			var stored_token = Cookies.get('token');
			if(stored_token){
				document.getElementById('token').value = stored_token;	
			}

			var input = document.getElementById("search");
			input.addEventListener("keyup", function(event) {
			  if (event.keyCode === 13) {
				event.preventDefault();
				document.getElementById("listblueprints").click();
			  }
			});	
			var input = document.getElementById("tags");
			input.addEventListener("keyup", function(event) {
			  if (event.keyCode === 13) {
				event.preventDefault();
				document.getElementById("listblueprints").click();
			  }
			});	
		</script>        
		<div class="accordion" id="blueprintAccordian" style="margin-top: 15px;"></div>

		<script>

			const blueprint_base_url = '{{ site.blueprints_base_url }}';
			const elements_base_url = '{{ site.elements_base_url }}';
			const tag_base_url = '{{ site.tags_base_url }}';
			const roles_base_url = '{{ site.roles_base_url }}';
			const links_base_url = '{{ site.links_base_url }}';
			const videos_base_url = '{{ site.videos_base_url }}';

			const questions_base_url = '{{ site.questions_base_url }}';
			const answers_base_url = '{{ site.answers_base_url }}';
			
		 	token = document.getElementById("token").value;	

			function autocomplete(inp, arr) {
				/*the autocomplete function takes two arguments,
				the text field element and an array of possible autocompleted values:*/
				var currentFocus;
				/*execute a function when someone writes in the text field:*/
				inp.addEventListener("input", function(e) {
					var a, b, i, val = this.value;
					/*close any already open lists of autocompleted values*/
					closeAllLists();
					if (!val) { return false;}
					currentFocus = -1;
					/*create a DIV element that will contain the items (values):*/
					a = document.createElement("DIV");
					a.setAttribute("id", this.id + "autocomplete-list");
					a.setAttribute("class", "autocomplete-items");
					/*append the DIV element as a child of the autocomplete container:*/
					this.parentNode.appendChild(a);
					/*for each item in the array...*/
					for (i = 0; i < arr.length; i++) {
					/*check if the item starts with the same letters as the text field value:*/
					//console.log(arr[i]);
					if (arr[i].substr(0, val.length).toUpperCase() == val.toUpperCase()) {
						/*create a DIV element for each matching element:*/
						b = document.createElement("DIV");
						/*make the matching letters bold:*/
						b.innerHTML = "<strong>" + arr[i].substr(0, val.length) + "</strong>";
						b.innerHTML += arr[i].substr(val.length);
						/*insert a input field that will hold the current array item's value:*/
						b.innerHTML += "<input type='hidden' value='" + arr[i] + "'>";
						/*execute a function when someone clicks on the item value (DIV element):*/
							b.addEventListener("click", function(e) {
							/*insert the value for the autocomplete text field:*/
							//console.log("HERE:" + this.getElementsByTagName("input")[0].value);
							inp.value = this.getElementsByTagName("input")[0].value;
							/*close the list of autocompleted values,
							(or any other open lists of autocompleted values:*/
							closeAllLists();
							addExistingElement();
						});
						a.appendChild(b);
					}
					}
				});
				/*execute a function presses a key on the keyboard:*/
				inp.addEventListener("keydown", function(e) {
					var x = document.getElementById(this.id + "autocomplete-list");
					if (x) x = x.getElementsByTagName("div");
					if (e.keyCode == 40) {
					/*If the arrow DOWN key is pressed,
					increase the currentFocus variable:*/
					currentFocus++;
					/*and and make the current item more visible:*/
					addActive(x);
					} else if (e.keyCode == 38) { //up
					/*If the arrow UP key is pressed,
					decrease the currentFocus variable:*/
					currentFocus--;
					/*and and make the current item more visible:*/
					addActive(x);
					} else if (e.keyCode == 13) {
					/*If the ENTER key is pressed, prevent the form from being submitted,*/
					e.preventDefault();
					if (currentFocus > -1) {
						/*and simulate a click on the "active" item:*/
						if (x) x[currentFocus].click();
					}
					}
				});
				function addActive(x) {
				/*a function to classify an item as "active":*/
				if (!x) return false;
				/*start by removing the "active" class on all items:*/
				removeActive(x);
				if (currentFocus >= x.length) currentFocus = 0;
				if (currentFocus < 0) currentFocus = (x.length - 1);
				/*add class "autocomplete-active":*/
				x[currentFocus].classList.add("autocomplete-active");
				}
				function removeActive(x) {
				/*a function to remove the "active" class from all autocomplete items:*/
				for (var i = 0; i < x.length; i++) {
					x[i].classList.remove("autocomplete-active");
				}
				}
				function closeAllLists(elmnt) {
				/*close all autocomplete lists in the document,
				except the one passed as an argument:*/
				var x = document.getElementsByClassName("autocomplete-items");
				for (var i = 0; i < x.length; i++) {
					if (elmnt != x[i] && elmnt != inp) {
					x[i].parentNode.removeChild(x[i]);
				}
				}
			}
			/*execute a function when someone clicks in the document:*/
			document.addEventListener("click", function (e) {
				closeAllLists(e.target);
			});
			} 			

			function listElements(){

				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		

				fetch(elements_base_url + '/elements?limit=1000&page=0',options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {	
							if(data){
								var all_elements = [];
								for (let i = 0; i < data.length; i++) {	
									all_elements.push(data[i].name);
								}		
							document.getElementById("element-store").value = JSON.stringify(data, null, 2);
							autocomplete(document.getElementById("add-element-name"), all_elements);	
							}																				 
						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});

				}				
													
				
				function listVideos(){

					const options = {
						method: 'get',
						headers: {
							"Content-Type": "application/json",
							"x-api-key": token,
						}
					};		

					fetch(videos_base_url + '/videos?limit=1000&page=0',options)
						.then(function(response) {
							if (!response.ok) {
								console.log('Error with Status Code: ' + response.status);
								return;
							}
							response.json().then(function(data) {	
								if(data){
									var all_videos = [];
									for (let i = 0; i < data.length; i++) {	
										all_videos.push(data[i].name);
									}		
								document.getElementById("video-store").value = JSON.stringify(data, null, 2);
								autocomplete(document.getElementById("add-video-name"), all_videos);	
								}																				 
							});
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});

					}					

			function listRoles(){

				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		

				fetch(roles_base_url + '/roles?limit=50&page=0',options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {
							var rows = '';
							rows += '<option value="">Role</option>';
							var all_roles = [];
							if(data){								
								for (let i = 0; i < data.length; i++) {	
									rows += '<option value="' + data[i].name + '">' + data[i].name + '</option>';
									all_roles.push(data[i].name);
								}								
							}
							document.getElementById('role').innerHTML = rows;	
							document.getElementById("role-store").value = JSON.stringify(data, null, 2);
							autocomplete(document.getElementById("add-role-name"), all_roles);

						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});

				}

				function updateBlueprintVideoRowField(u){

					var ua = u.id.split("~");
					var field = ua[2];
					var id = ua[3];

					var name = document.getElementById('blueprint~video~name~' + id).value;
					var description = document.getElementById('blueprint~video~description~' + id).value;

					var postData = {};
					postData.name = name;
					postData.description = description;

					delete postData.id;
					var options = {
							method: "PUT",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							},
							body: JSON.stringify(postData)
						};

					fetch(blueprint_base_url + '/videos/' + id,options)
						.then(function(response) {
							console.log("Updated!");
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});				

					}				

				function deleteVideo(b_id,v_id){

					var options = {
							method: "DELETE",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							}
						};
					console.log(blueprint_base_url + '/blueprints/' + b_id + '/videos/' + v_id);
					fetch(blueprint_base_url + '/blueprints/' + b_id + '/videos/' + v_id,options)
						.then(function(response) {
							console.log("DELETED!");	
							listBlueprintVideos(b_id)
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});	

					}	

				function addVideo(){

					var b_id = document.getElementById('add-video-blueprint-id').value;
					var a_id = document.getElementById('add-video-area-id').value;
					var name = document.getElementById('add-video-name').value;
					var description = document.getElementById('add-video-description').value;
					var image = '';

					var postData = {};
					postData.name = name;
					postData.description = description;

					var options = {
							method: "POST",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							},
							body: JSON.stringify(postData)
						};
					//console.log(options);
					console.log(videos_base_url + '/videos');
					console.log(options);
					fetch(videos_base_url + '/videos',options)
						.then(function(response) {
							response.json().then(function(data) {
							
							console.log("----");
							console.log(data);
							console.log("----");

							var postData = {};
							postData.name = name;
							postData.video_id = data.id;

							var options = {
									method: "POST",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									},
									body: JSON.stringify(postData)
								};
							
							console.log(videos_base_url + '/blueprints/' + b_id + '/videos');
							console.log(options);

							fetch(blueprint_base_url + '/blueprints/' + b_id + '/videos',options)
								.then(function(response) {
									response.json().then(function(data) {
									//console.log(data);
									listBlueprintVideos(b_id);
								});
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});	

						});
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});	

					$("#addVideo").modal('hide');	

					}						

				function blueprintVideosRow(b_id,row){

					var html = '';				
					html += '<tr>';
					html += '<td width="25%"><input type="text" onchange="updateBlueprintVideoRowField(this);" class="form-control" id="blueprint~video~name~' + row.video_id + '" placeholder="" value="' + row.name + '"></td>';
					html += '<td width="55%"><textarea class="form-control" onchange="updateBlueprintVideoRowField(this);" id="blueprint~video~description~' + row.video_id + '" rows="3">' + row.description + '</textarea></td>';
					html += '<td width="10%"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteVideo(' + b_id + ',' + row.video_id + ') }" style="width: 125px;"></td>';
					html += '</tr>';	

					return html;
					}	

				function listBlueprintVideos(b_id){
						const options = {
							method: 'get',
							headers: {
								"Content-Type": "application/json",
								"x-api-key": token,
							}
						};		

						fetch(blueprint_base_url + '/blueprints/' + b_id + '/videos',options)
							.then(function(response) {
								if (!response.ok) {
									console.log('Error with Status Code: ' + response.status);
									return;
								}
								response.json().then(function(data) {
									var rows = '';
									if(data){
										var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
										//console.log(data);
										if(data.length == 0){
												rows += '<tr><td><p align="center">No Areas</p></td></tr>';
											}
										else{										
											for (let i = 0; i < data.length; i++) {
												rows += blueprintVideosRow(b_id,data[i]);
											}
										}
										rows += '</table></center>';
										document.getElementById("video-list~" + b_id).innerHTML = rows;							
									}
								});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});

						}	
						

					function updateBlueprintRoleRowField(u){

						var ua = u.id.split("~");
						var field = ua[2];
						var id = ua[3];

						var name = document.getElementById('blueprint~role~name~' + id).value;
						var description = document.getElementById('blueprint~role~description~' + id).value;

						var postData = {};
						postData.name = name;
						postData.description = description;

						delete postData.id;
						var options = {
								method: "PUT",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};

						fetch(blueprint_base_url + '/roles/' + id,options)
							.then(function(response) {
								console.log("Updated!");
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});				

						}				

						function deleteRole(b_id,v_id){

						var options = {
								method: "DELETE",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								}
							};
						console.log(blueprint_base_url + '/blueprints/' + b_id + '/roles/' + v_id);
						fetch(blueprint_base_url + '/blueprints/' + b_id + '/roles/' + v_id,options)
							.then(function(response) {
								console.log("DELETED!");	
								listBlueprintRoles(b_id)
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						}	

						function addRole(){

						var b_id = document.getElementById('add-role-blueprint-id').value;
						var a_id = document.getElementById('add-role-area-id').value;
						var name = document.getElementById('add-role-name').value;
						var description = document.getElementById('add-role-description').value;
						var image = '';

						var postData = {};
						postData.name = name;
						postData.description = description;

						var options = {
								method: "POST",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};
						//console.log(options);
						console.log(roles_base_url + '/roles');
						console.log(options);
						fetch(roles_base_url + '/roles',options)
							.then(function(response) {
								response.json().then(function(data) {
								
								console.log("----");
								console.log(data);
								console.log("----");

								var postData = {};
								postData.name = name;
								postData.role_id = data.id;

								var options = {
										method: "POST",
										headers: {
										"Content-Type": "application/json",
										"x-api-key": token
										},
										body: JSON.stringify(postData)
									};
								
								console.log(roles_base_url + '/blueprints/' + b_id + '/roles');
								console.log(options);

								fetch(blueprint_base_url + '/blueprints/' + b_id + '/roles',options)
									.then(function(response) {
										response.json().then(function(data) {
										//console.log(data);
										listBlueprintRoles(b_id);
									});
									})
									.catch(function(err) {
										console.log('Error: ' + err);
								});	

							});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						$("#addRole").modal('hide');	

						}						

						function blueprintRolesRow(b_id,row){

						var html = '';				
						html += '<tr>';
						html += '<td width="25%"><input type="text" onchange="updateBlueprintRoleRowField(this);" class="form-control" id="blueprint~role~name~' + row.role_id + '" placeholder="" value="' + row.name + '"></td>';
						html += '<td width="55%"><textarea class="form-control" onchange="updateBlueprintRoleRowField(this);" id="blueprint~role~description~' + row.role_id + '" rows="3">' + row.description + '</textarea></td>';
						html += '<td width="10%"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteRole(' + b_id + ',' + row.role_id + ') }" style="width: 125px;"></td>';
						html += '</tr>';	

						return html;
						}	

						function listBlueprintRoles(b_id){
							const options = {
								method: 'get',
								headers: {
									"Content-Type": "application/json",
									"x-api-key": token,
								}
							};		

							fetch(blueprint_base_url + '/blueprints/' + b_id + '/roles',options)
								.then(function(response) {
									if (!response.ok) {
										console.log('Error with Status Code: ' + response.status);
										return;
									}
									response.json().then(function(data) {
										var rows = '';
										if(data){
											var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
											//console.log(data);
											if(data.length == 0){
													rows += '<tr><td><p align="center">No Areas</p></td></tr>';
												}
											else{										
												for (let i = 0; i < data.length; i++) {
													rows += blueprintRolesRow(b_id,data[i]);
												}
											}
											rows += '</table></center>';
											document.getElementById("role-list~" + b_id).innerHTML = rows;							
										}
									});
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});

							}							
												

				function listLinks(){

					const options = {
						method: 'get',
						headers: {
							"Content-Type": "application/json",
							"x-api-key": token,
						}
					};		

					fetch(links_base_url + '/links?limit=1000&page=0',options)
						.then(function(response) {
							if (!response.ok) {
								console.log('Error with Status Code: ' + response.status);
								return;
							}
							response.json().then(function(data) {	
								if(data){
									var all_links = [];
									for (let i = 0; i < data.length; i++) {	
										all_links.push(data[i].name);
									}		
								document.getElementById("link-store").value = JSON.stringify(data, null, 2);
								autocomplete(document.getElementById("add-link-name"), all_links);	
								}																				 
							});
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});

					}							

					function updateBlueprintLinkRowField(u){

						var ua = u.id.split("~");
						var field = ua[2];
						var id = ua[3];

						var name = document.getElementById('blueprint~link~name~' + id).value;
						var description = document.getElementById('blueprint~link~description~' + id).value;

						var postData = {};
						postData.name = name;
						postData.description = description;

						delete postData.id;
						var options = {
								method: "PUT",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};

						fetch(links_base_url + '/links/' + id,options)
							.then(function(response) {
								console.log("Updated!");
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});				

						}

					function deleteLink(b_id,l_id){

						var options = {
								method: "DELETE",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								}
							};
						console.log(blueprint_base_url + '/blueprints/' + b_id + '/links/' + l_id);
						fetch(blueprint_base_url + '/blueprints/' + b_id + '/links/' + l_id,options)
							.then(function(response) {
								console.log("DELETED!");	
								listBlueprintLinks(b_id)
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						}	
						
					function addLink(){

						var b_id = document.getElementById('add-link-blueprint-id').value;
						var name = document.getElementById('add-link-name').value;
						var url = document.getElementById('add-link-url').value;
						var description = document.getElementById('add-link-description').value;
						var image = '';

						var postData = {};
						postData.name = name;
						postData.description = description;
						postData.url = url;

						var options = {
								method: "POST",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};
						//console.log(options);
						console.log(links_base_url + '/links');
						console.log(options);
						fetch(links_base_url + '/links',options)
							.then(function(response) {
								response.json().then(function(data) {
								
								console.log("----");
								console.log(data);
								console.log("----");

								var postData = {};
								postData.name = name;
								postData.link_id = data.id;

								var options = {
										method: "POST",
										headers: {
										"Content-Type": "application/json",
										"x-api-key": token
										},
										body: JSON.stringify(postData)
									};
								
								console.log(blueprint_base_url + '/blueprints/' + b_id + '/links');
								console.log(options);

								fetch(blueprint_base_url + '/blueprints/' + b_id + '/links',options)
									.then(function(response) {
										response.json().then(function(data) {
										//console.log(data);
										listBlueprintLinks(b_id);
									});
									})
									.catch(function(err) {
										console.log('Error: ' + err);
								});	

							});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						$("#addLink").modal('hide');	

						}							
						
					function blueprintLinksRow(b_id,row){

						var html = '';				
						html += '<tr>';
						html += '<td width="25%" align="right"><strong>Name:</strong></td><td><input type="text" onchange="updateBlueprintLinkRowField(this);" class="form-control" id="blueprint~link~name~' + row.link_id + '" placeholder="" value="' + row.name + '"></td><td></td>';
						html += '</tr>';
						html += '<tr>';
						html += '<td width="25%" align="right"><strong>Description:</strong></td><td><textarea class="form-control" onchange="updateBlueprintLinkRowField(this);" id="blueprint~link~description~' + row.link_id + '" rows="3">' + row.description + '</textarea></td><td></td>';
						html += '</tr>';
						html += '<tr>';
						html += '<td width="25%" align="right"><a href="' + row.url + '"><strong>URL:</strong></a>/td><td><input type="text" onchange="updateBlueprintLinkRowField(this);" class="form-control" id="blueprint~link~url~' + row.link_id + '" placeholder="" value="' + row.url + '"></td><td></td>';
						html += '</tr>';
						html += '<tr>';														
						html += '<td width="25%" align="right"></td><td><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteLink(' + b_id + ',' + row.link_id + ') }" style="width: 125px;"></td><td></td>';
						html += '</tr>';	

						return html;
						}						
					
					function listBlueprintLinks(b_id){
						const options = {
							method: 'get',
							headers: {
								"Content-Type": "application/json",
								"x-api-key": token,
							}
						};		

						fetch(blueprint_base_url + '/blueprints/' + b_id + '/links',options)
							.then(function(response) {
								if (!response.ok) {
									console.log('Error with Status Code: ' + response.status);
									return;
								}
								response.json().then(function(data) {
									var rows = '';
									if(data){
										var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
										//console.log(data);
										if(data.length == 0){
												rows += '<tr><td><p align="center">No Links</p></td></tr>';
											}
										else{										
											for (let i = 0; i < data.length; i++) {
												rows += blueprintLinksRow(b_id,data[i]);
											}
										}
										rows += '</table></center>';
										document.getElementById("link-list~" + b_id).innerHTML = rows;							
									}
								});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});

						}

					function listAnswers(){

						const options = {
							method: 'get',
							headers: {
								"Content-Type": "application/json",
								"x-api-key": token,
							}
						};		

						fetch(answers_base_url + '/answers?limit=1000&page=0',options)
							.then(function(response) {
								if (!response.ok) {
									console.log('Error with Status Code: ' + response.status);
									return;
								}
								response.json().then(function(data) {	
									if(data){
										var all_answers = [];
										for (let i = 0; i < data.length; i++) {	
											all_answers.push(data[i].name);
										}		
									document.getElementById("answer-store").value = JSON.stringify(data, null, 2);
									autocomplete(document.getElementById("add-answer-name"), all_answers);	
									}																				 
								});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});

						}	

					function updateBlueprintAnswerRowField(u){

						var ua = u.id.split("~");
						var field = ua[2];
						var id = ua[3];

						var name = document.getElementById('blueprint~answer~name~' + id).value;

						var postData = {};
						postData.name = name;
						postData.description = description;

						delete postData.id;
						var options = {
								method: "PUT",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};

						fetch(answers_base_url + '/answers/' + id,options)
							.then(function(response) {
								console.log("Updated!");
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});				

						}

						function deleteAnswer(b_id,l_id){

						var options = {
								method: "DELETE",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								}
							};
						console.log(blueprint_base_url + '/blueprints/' + b_id + '/answers/' + l_id);
						fetch(blueprint_base_url + '/blueprints/' + b_id + '/answers/' + l_id,options)
							.then(function(response) {
								console.log("DELETED!");	
								listBlueprintAnswers(b_id)
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						}	

					function addAnswer(){

						var b_id = document.getElementById('add-answer-blueprint-id').value;
						var name = document.getElementById('add-answer-name').value;
						var description = document.getElementById('add-answer-description').value;
						var image = '';

						var postData = {};
						postData.name = name;
						postData.description = description;

						var options = {
								method: "POST",
								headers: {
								"Content-Type": "application/json",
								"x-api-key": token
								},
								body: JSON.stringify(postData)
							};
						fetch(answers_base_url + '/answers',options)
							.then(function(response) {
								response.json().then(function(data) {
								
								console.log("----");
								console.log(data);
								console.log("----");

								var postData = {};
								postData.name = name;
								postData.answer_id = data.id;

								var options = {
										method: "POST",
										headers: {
										"Content-Type": "application/json",
										"x-api-key": token
										},
										body: JSON.stringify(postData)
									};
								
								console.log(blueprint_base_url + '/blueprints/' + b_id + '/answers');
								console.log(options);

								fetch(blueprint_base_url + '/blueprints/' + b_id + '/answers',options)
									.then(function(response) {
										response.json().then(function(data) {
										//console.log(data);
										listBlueprintAnswers(b_id);
									});
									})
									.catch(function(err) {
										console.log('Error: ' + err);
								});	

							});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});	

						$("#addAnswer").modal('hide');	

						}							

					function blueprintAnswersRow(b_id,row){

						var html = '';				
						html += '<tr>';
						html += '<td width="25%"><input type="text" onchange="updateBlueprintAnswerRowField(this);" class="form-control" id="blueprint~answer~name~' + row.answer_id + '" placeholder="" value="' + row.name + '"></td>';
						html += '<td width="10%"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteAnswer(' + b_id + ',' + row.answer_id + ') }" style="width: 125px;"></td>';
						html += '</tr>';	

						return html;
						}						

						function listBlueprintAnswers(b_id){
						const options = {
							method: 'get',
							headers: {
								"Content-Type": "application/json",
								"x-api-key": token,
							}
						};		

						fetch(blueprint_base_url + '/blueprints/' + b_id + '/answers',options)
							.then(function(response) {
								if (!response.ok) {
									console.log('Error with Status Code: ' + response.status);
									return;
								}
								response.json().then(function(data) {
									var rows = '';
									if(data){
										var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
										//console.log(data);
										if(data.length == 0){
												rows += '<tr><td><p align="center">No Answers</p></td></tr>';
											}
										else{										
											for (let i = 0; i < data.length; i++) {
												rows += blueprintAnswersRow(b_id,data[i]);
											}
										}
										rows += '</table></center>';
										document.getElementById("answer-list~" + b_id).innerHTML = rows;							
									}
								});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});

						}

					function listQuestions(){

						const options = {
							method: 'get',
							headers: {
								"Content-Type": "application/json",
								"x-api-key": token,
							}
						};		

						fetch(questions_base_url + '/questions?limit=1000&page=0',options)
							.then(function(response) {
								if (!response.ok) {
									console.log('Error with Status Code: ' + response.status);
									return;
								}
								response.json().then(function(data) {	
									if(data){
										var all_questions = [];
										for (let i = 0; i < data.length; i++) {	
											all_questions.push(data[i].name);
										}		
									document.getElementById("question-store").value = JSON.stringify(data, null, 2);
									autocomplete(document.getElementById("add-question-name"), all_questions);	
									}																				 
								});
							})
							.catch(function(err) {
								console.log('Error: ' + err);
						});

						}	

						function updateBlueprintQuestionRowField(u){

							var ua = u.id.split("~");
							var field = ua[2];
							var id = ua[3];

							var name = document.getElementById('blueprint~question~name~' + id).value;

							var postData = {};
							postData.name = name;

							delete postData.id;
							var options = {
									method: "PUT",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									},
									body: JSON.stringify(postData)
								};

							fetch(questions_base_url + '/questions/' + id,options)
								.then(function(response) {
									console.log("Updated!");
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});				

							}

						function deleteQuestion(b_id,l_id){

							var options = {
									method: "DELETE",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									}
								};
							console.log(blueprint_base_url + '/blueprints/' + b_id + '/questions/' + l_id);
							fetch(blueprint_base_url + '/blueprints/' + b_id + '/questions/' + l_id,options)
								.then(function(response) {
									console.log("DELETED!");	
									listBlueprintQuestions(b_id)
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});	

							}	

						function addQuestion(){

							var b_id = document.getElementById('add-question-blueprint-id').value;
							var name = document.getElementById('add-question-name').value;
							var description = document.getElementById('add-question-description').value;
							var image = '';

							var postData = {};
							postData.name = name;
							postData.description = description;

							var options = {
									method: "POST",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									},
									body: JSON.stringify(postData)
								};
							//console.log(options);
							console.log(questions_base_url + '/questions');
							console.log(options);
							fetch(questions_base_url + '/questions',options)
								.then(function(response) {
									response.json().then(function(data) {
									
									console.log("----");
									console.log(data);
									console.log("----");

									var postData = {};
									postData.name = name;
									postData.question_id = data.id;

									var options = {
											method: "POST",
											headers: {
											"Content-Type": "application/json",
											"x-api-key": token
											},
											body: JSON.stringify(postData)
										};
									
									console.log(blueprint_base_url + '/blueprints/' + b_id + '/questions');
									console.log(options);

									fetch(blueprint_base_url + '/blueprints/' + b_id + '/questions',options)
										.then(function(response) {
											response.json().then(function(data) {
											//console.log(data);
											listBlueprintQuestions(b_id);
										});
										})
										.catch(function(err) {
											console.log('Error: ' + err);
									});	

								});
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});	

							$("#addQuestion").modal('hide');	

							}							

						function blueprintQuestionsRow(b_id,row){

							var html = '';				
							html += '<tr>';
							html += '<td width="25%"><input type="text" onchange="updateBlueprintQuestionRowField(this);" class="form-control" id="blueprint~question~name~' + row.question_id + '" placeholder="" value="' + row.name + '"></td>';
							html += '<td width="10%"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteQuestion(' + b_id + ',' + row.question_id + ') }" style="width: 125px;"></td>';
							html += '</tr>';	

							return html;
							}						

						function listBlueprintQuestions(b_id){
							const options = {
								method: 'get',
								headers: {
									"Content-Type": "application/json",
									"x-api-key": token,
								}
							};		

							fetch(blueprint_base_url + '/blueprints/' + b_id + '/questions',options)
								.then(function(response) {
									if (!response.ok) {
										console.log('Error with Status Code: ' + response.status);
										return;
									}
									response.json().then(function(data) {
										var rows = '';
										if(data){
											var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
											//console.log(data);
											if(data.length == 0){
												rows += '<tr><td><p align="center">No Questions</p></td></tr>';
											}
											else{											
												for (let i = 0; i < data.length; i++) {
													rows += blueprintQuestionsRow(b_id,data[i]);
												}
											}
											rows += '</table></center>';
											document.getElementById("question-list~" + b_id).innerHTML = rows;							
										}
									});
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});

							}						

						
				function deleteElement(b_id,a_id,e_id){

					var options = {
							method: "DELETE",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							}
						};
					console.log(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id + '/elements/' + e_id);
					fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id + '/elements/' + e_id,options)
						.then(function(response) {
							console.log("DELETED!");	
							listBlueprintAreasElements(b_id,a_id)
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});	

					}						

				function addElement(){

					var b_id = document.getElementById('add-element-blueprint-id').value;
					var a_id = document.getElementById('add-element-area-id').value;
					var name = document.getElementById('add-element-name').value;
					var description = document.getElementById('add-element-description').value;
					var image = '';

					var postData = {};
					postData.name = name;
					postData.description = description;

					var options = {
							method: "POST",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							},
							body: JSON.stringify(postData)
						};
					console.log(elements_base_url + '/elements');
					console.log(options);
					fetch(elements_base_url + '/elements',options)
						.then(function(response) {
							response.json().then(function(data) {
							
							console.log("----");
							console.log(data);
							console.log("----");

							var postData = {};
							postData.name = name;
							postData.element_id = data.id;

							var options = {
									method: "POST",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									},
									body: JSON.stringify(postData)
								};
							
							console.log(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id + '/elements');
							console.log(options);

							fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id + '/elements',options)
								.then(function(response) {
									response.json().then(function(data) {
									//console.log(data);
									listBlueprintAreasElements(b_id,a_id);
								});
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});	

						});
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});	

					$("#addElement").modal('hide');	

					}				


			function blueprintAreasElementsHTMLRow(b_id,a_id,row){

				var html = '<li><strong>' + row.name + '</strong> - ' + row.description + '</li>';
				return html;

				}

			function blueprintAreasElementsRow(b_id,a_id,row){

				var html = '';				
				html += '<tr>';
				html += '<td width="25%"><input type="text" onchange="updateElementRowField(this);" class="form-control" id="name~' + row.id + '" placeholder="" value="' + row.name + '"></td>';
				html += '<td width="55%"><textarea class="form-control" onchange="updateElementRowField(this);" id="description~' + row.id + '" rows="3">' + row.description + '</textarea></td>';
				html += '<td width="10%"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteElement(' + b_id + ',' + a_id + ',' + row.id + ') }" style="width: 125px;"></td>';
				html += '<textarea class="form-control" id="bstore~' + b_id + '~' + a_id + '~' + row.id + '" rows="5" style="display: none;">' + JSON.stringify(row, null, 2) + '</textarea>';
				html += '</tr>';	

				return html;
				}

			function listBlueprintAreasElements(b_id,a_id){
				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		

				fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id + '/elements',options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {
							var rows = '';
							if(data){
								var rows = '<center><table style="border: 0px solid #000; width: 80%;">';
								//console.log(data);
								if(data.length == 0){
									rows += '<p align="center">No Elements</p>';
								}
								else{	
									var blueprint_html = document.getElementById("bview~" + b_id).value;							

									var list = '<ul>';
									for (let i = 0; i < data.length; i++) {
										rows += blueprintAreasElementsRow(b_id,a_id,data[i]);											
										list += blueprintAreasElementsHTMLRow(b_id,a_id,data[i]);																			
									}
									list += '</ul>';
									document.getElementById("bview~" + b_id).value = blueprint_html;		
								}
								rows += '</table></center>';

								// somehackystuff
								blueprint_html_array = blueprint_html.split('~' + a_id + '~');
								blueprint_html = blueprint_html_array[0] + list + blueprint_html_array[1];
								document.getElementById("bview~" + b_id).value = blueprint_html;

								document.getElementById("area-element-list~" + b_id + '-' + a_id).innerHTML = rows;															
							}
						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});

				}

				function deleteArea(b_id,a_id){

					var options = {
							method: "DELETE",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							}
						};
					console.log(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id);
					fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas/' + a_id,options)
						.then(function(response) {
							console.log("DELETED!");	
							listBlueprintAreas(b_id)(b_id)
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});	

					}					

				function updateBlueprintArea(b_id,a_id){

					const postData = JSON.parse(document.getElementById('bstore~' + b_id + "~" + a_id).value);

					delete postData.id;
					delete postData.blueprint_id;
					var options = {
							method: "PUT",
							headers: {
							"Content-Type": "application/json",
							"x-api-key": token
							},
							body: JSON.stringify(postData)
						};
					console.log(options);
					fetch(blueprint_base_url + '/blueprints/' + b_id + "/areas/" + a_id,options)
						.then(function(response) {
							//console.log("Updated!");
							//console.log(response);
						})
						.catch(function(err) {
							console.log('Error: ' + err);
					});				

					}				

				function updateBlueprintAreaRowField(u){

					var ua = u.id.split("~");
					var field = ua[0];
					var b_id = ua[1];
					var a_id = ua[2];

					var bstore = JSON.parse(document.getElementById('bstore~' + b_id + "~" + a_id).value);

					bstore[field] = u.value;
	
					document.getElementById('bstore~' + b_id + "~" + a_id).value = JSON.stringify(bstore, null, 2);

					updateBlueprintArea(b_id,a_id);

					}				

			function blueprintAreaHTMLRow(row,b_id){

				var html = '';
				html += '<h3 id="html-heading-' + row.id + '">' + row.label + '</h3>';				
				html += '<p>' + row.description + '</p>';
				html += '~' + row.id + '~';
				
				return html;

			}

			function blueprintAreaRow(row,b_id){

				var html = '';				

				html += '<div class="form-group" style="display: none;">';
				html += '<textarea class="form-control" id="bstore~' + b_id + '~' + row.id + '" rows="5">' + JSON.stringify(row, null, 2) + '</textarea>';
				html += '</div>';
					
				html += '<div style="background-color: #CCC; padding: 10px; color: #000; font-weight: bold; font-size: 24px;">';
				html += row.label;
				html += '</div>';

				html += '<center><table style="width: 90%; border: 0px solid #000;">';					
				html += '<tr><td style="width: 15%; text-align: right;"><strong>Sort Order:</strong></td><td><input type="text" onchange="updateBlueprintAreaRowField(this);" class="form-control" id="sort_order~' + b_id + '~' + row.id + '" placeholder="" value="' + row.sort_order + '"></td><td width="5%" align="center"><input type="button" class="btn btn-danger" name="delete" value="DELETE" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteArea(' + b_id + ',' + row.id + ') }" style="width: 125px;"></td></tr>';
				html += '<tr><td style="width: 15%; text-align: right;"><strong>Label:</strong></td><td><input type="text" style="width: 100%;" onchange="updateBlueprintAreaRowField(this);" class="form-control" id="label~' + b_id + '~' + row.id + '" placeholder="" value="' + row.label + '"></td></td><td></td></tr>';
				html += '<tr><td style="width: 15%; text-align: right;"><strong>Description:</strong></td><td><textarea class="form-control" style="width: 100%;" onchange="updateBlueprintAreaRowField(this);" id="description~' + b_id + '~' + row.id + '" rows="3">' + row.description + '</textarea></td></td><td></td></tr>';
				html += '<tr><td style="width: 15%; text-align: right;"><strong>Image:</strong></td><td><input type="text" style="width: 100%;" class="form-control" onchange="updateBlueprintAreaRowField(this);" id="image~' + b_id + '~' + row.id + '" placeholder="images/blueprints/image.jpeg" value="' + row.image + '"></td></td><td></td></tr>';
				html += '</table></center>';	
				
				html += '<br><div class="col-5">';
				html += '<h5 style="padding-left: 55px;">Elements (<a href="#" onclick="openAddElementModal(' + b_id + ',' + row.id + ');">Add</a>)</h5>';
				html += '</div>';					
				html += '<div class="row">';			
				html += '<div class="container" id="area-element-list~' + b_id + '-' + row.id + '" style="padding: 10px;">';
				html += '</div>';						
				html += '</div>';
				html += '</div>';				
				
				html += '<hr>';

				return html;
			}

			function addArea(){
				
				var b_id = document.getElementById('add-area-blueprint-id').value;
				var sort_order = document.getElementById('add-area-sort-order').value;
				var label = document.getElementById('add-area-label').value;
				var description = document.getElementById('add-area-description').value;
				var image = document.getElementById('add-area-image').value;

				var postData = {};
				postData.sort_order = sort_order;
				postData.label = label;
				postData.description = description;
				postData.image = image;

				console.log(JSON.stringify(postData));

				var options = {
						method: "POST",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						},
						body: JSON.stringify(postData)
					};

				fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas',options)
					.then(function(response) {
						console.log(response);
						listBlueprintAreas(b_id);
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});	

				$("#addArea").modal('hide');	

				}	
							

			function listBlueprintAreas(b_id){
				
				//console.log("Loading Areas...");
				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		
				console.log(blueprint_base_url + '/blueprints/' + b_id + '/areas/');
				fetch(blueprint_base_url + '/blueprints/' + b_id + '/areas/',options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {
							var rows = '';
							console.log(data);
							if(data){
								var rows = '';
								console.log(data.length);
								for (let i = 0; i < data.length; i++) {
									//rows += '<div class="col-auto">' + data[i].name + '  <a href="#" onclick="deleteBlueprintArea(' + b_id + ',' + data[i].area_id + '); return false;" style="text-decoration: none;">&#10060;</a></div>';
									rows += blueprintAreaRow(data[i],b_id);
									document.getElementById("area-list~" + b_id).innerHTML = rows;																		
									
									var blueprint_html = document.getElementById("bview~" + b_id).value;
									blueprint_html += blueprintAreaHTMLRow(data[i],b_id);
									document.getElementById("bview~" + b_id).value = blueprint_html;
									
									listBlueprintAreasElements(b_id,data[i].id);	
								}															
							}
							else{
								rows += '<p align="center">No Areas</p>';	
								document.getElementById("area-list~" + b_id).innerHTML = rows;						
							}							
						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});

				}

			function deleteBlueprintTag(id,tag_id){

				var options = {
						method: "DELETE",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						}
					};
				fetch(blueprint_base_url + '/blueprints/' + id + "/tags/" + tag_id,options)
					.then(function(response) {						
						getBlueprintTags(id);
						console.log("DELETED!");
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});	

				}

			function addBlueprintTag(id){

				var name = document.getElementById('add-tag~' + id).value;

				var postData = {};
				postData.name = name;
				console.log(postData);

				var options = {
						method: "POST",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						},
						body: JSON.stringify(postData)
					};

				fetch(tag_base_url + '/tags/',options)
					.then(function(response) {

						response.json().then(function(data) {
							var tag_id = data.id;
							var postData = {};
							postData.blueprint_id = id;
							postData.tag_id = tag_id;
							var options = {
									method: "POST",
									headers: {
									"Content-Type": "application/json",
									"x-api-key": token
									},
									body: JSON.stringify(postData)
								};

							fetch(blueprint_base_url + '/blueprints/' + id + '/tags',options)
								.then(function(response) {
									getBlueprintTags(id);							
								})
								.catch(function(err) {
									console.log('Error: ' + err);
							});		
						
						});	

					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});					

				$("#addBlueprint").modal('hide');	

			}

			function getBlueprintTags(b_id){

				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		
		
				fetch(blueprint_base_url + '/blueprints/' + b_id + '/tags',options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {
							var rows = '<div class="row-auto">';
							for (let i = 0; i < data.length; i++) {
								rows += '<div class="col-auto">' + data[i].name + '  <a href="#" onclick="deleteBlueprintTag(' + b_id + ',' + data[i].tag_id + '); return false;" style="text-decoration: none;">&#10060;</a></div>';
							}
							document.getElementById("tag-list~" + b_id).innerHTML = rows;
						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});				
			}

			$('#blueprintAccordian').on('show.bs.collapse', function (e) {
				var row_id = e.target.id;
				var b_id = row_id.replace("collapse-","");						
		
				getBlueprintTags(b_id);
				listBlueprintAreas(b_id);
				listBlueprintLinks(b_id);
				listBlueprintVideos(b_id);
				listBlueprintQuestions(b_id);
				listBlueprintAnswers(b_id);
				listBlueprintRoles(b_id);

			 	//alert("bluerprint: " + b_id);
			})

			$('#blueprintAccordian').on('hidden.bs.collapse', function (e) {
				var row_id = e.target.id;
				var b_id = row_id.replace("collapse-","");
			 	//alert("bluerprint: " + b_id);
			})	

			function deleteBlueprint(id){

				var options = {
						method: "DELETE",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						}
					};

				fetch(blueprint_base_url + '/blueprints/' + id,options)
					.then(function(response) {
						console.log("DELETED!");
						listBlueprints();
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});	

			}

			function addBlueprint(){

				var name = document.getElementById('add-name').value;
				var description = document.getElementById('add-description').value;
				var image = document.getElementById('add-image').value;
				var version = document.getElementById('add-version').value;
				var state = document.getElementById('add-state').value;
				var maturity = document.getElementById('add-maturity').value;
				var level = document.getElementById('add-level').value;

				var postData = {};
				postData.name = name;
				postData.description = description;
				postData.image = image;
				postData.version = version;
				postData.state = state;
				postData.maturity = maturity;
				postData.level = level;

				var options = {
						method: "POST",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						},
						body: JSON.stringify(postData)
					};

				fetch(blueprint_base_url + '/blueprints/',options)
					.then(function(response) {
						console.log("Added!");
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});	

				$("#addBlueprint").modal('hide');	
			}			
			
			function openAddBueprintModal(){
				$("#addBlueprint").modal('show');				
			}

			function closeAddBlueprintModal(){
				$("#addBlueprint").modal('hide');				
			}	
			
			function openAddAreaModal(b_id){
				$("#addArea").modal('show');	
				document.getElementById('add-area-blueprint-id').value = b_id;	
				console.log("1) " + b_id);		
			}

			function closeAddAreaModal(){
				$("#addArea").modal('hide');				
			}	
			
			function openAddElementModal(b_id,a_id){

				document.getElementById('add-element-blueprint-id').value = b_id;
				document.getElementById('add-element-area-id').value = a_id;
				$("#addElement").modal('show');				
			}

			function closeAddElementModal(){
				$("#addElement").modal('hide');			
			}	
			
			function openAddLinkModal(b_id){

			document.getElementById('add-link-blueprint-id').value = b_id;
			$("#addLink").modal('show');				
			}

			function closeAddLinkModal(){
			$("#addLink").modal('hide');			
			}	
			
			function openAddVideoModal(b_id){

			document.getElementById('add-video-blueprint-id').value = b_id;
			$("#addVideo").modal('show');				
			}

			function closeAddVideoModal(){
			$("#addVideo").modal('hide');			
			}	
			
			function openAddRoleModal(b_id){

			document.getElementById('add-role-blueprint-id').value = b_id;
			$("#addRole").modal('show');				
			}

			function closeAddRoleModal(){
			$("#addRole").modal('hide');			
			}				
						
			function openAddQuestionModal(b_id){

			document.getElementById('add-question-blueprint-id').value = b_id;
			$("#addQuestion").modal('show');				
			}

			function closeAddQuestionModal(){
			$("#addQuestion").modal('hide');			
			}	
			
			function openAddAnswerModal(b_id,a_id){

			document.getElementById('add-answer-blueprint-id').value = b_id;
			$("#addAnswer").modal('show');				
			}

			function closeAddAnswerModal(){
			$("#addAnswer").modal('hide');			
			}	
			
			function openViewBlueprintModal(b_id,a_id){
			$("#viewBlueprint").modal('show');				
			}

			function closeViewBlueprintModal(){
			$("#viewBlueprint").modal('hide');			
			}			
			
			function viewBlueprint(id){

				var viewHTML = document.getElementById('bview~' + id).value;
				document.getElementById('viewBlueprintBody').innerHTML = viewHTML;
				openViewBlueprintModal();
			}			
			
			function updateBlueprint(id){

				const postData = JSON.parse(document.getElementById('bstore~' + id).value);

				delete postData.id;
				var options = {
						method: "PUT",
						headers: {
						"Content-Type": "application/json",
						"x-api-key": token
						},
						body: JSON.stringify(postData)
					};

				fetch(blueprint_base_url + '/blueprints/' + id,options)
					.then(function(response) {
						console.log("Updated!");
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});				

			}

			function updateBlueprintRowField(u){

				var ua = u.id.split("~");
				var field = ua[0];
				var id = ua[1];

				var bstore = JSON.parse(document.getElementById('bstore~' + id).value);
				
				bstore[field] = u.value;

				document.getElementById('toggle-row-' + id).innerHTML = bstore.name + ' (' + bstore.level + ')';

				document.getElementById('bstore~' + id).value = JSON.stringify(bstore, null, 2);

				updateBlueprint(id);

			}

			function blueprintHTMLRow(row,i){
				var html = '';					
				html += '<h2 id="html-heading-' + row.id + '">' + row.name + '</h2>';				
				html += '<p>' + row.description + '</p>';
				return html;
			}

			function blueprintRow(row,i){
				var html = '';

				html += '<div style="display: none;">';
				html += '<textarea class="form-control" id="bview~' + row.id + '" rows="5">bview~' + row.id + '</textarea>';
				html += '</div>';

				html += '<div class="accordion-item" id="blueprint-' + row.id + '">';					
				html += '<h2 class="accordion-header" id="heading-' + row.id + '">';	
				html += '<button id="toggle-row-' + row.id + '" class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-' + row.id + '" aria-expanded="false" aria-controls="collapse-' + row.id + '" style="color: #000;">';	
				html += row.name + ' (Level: ' + row.level + ')';
				html += '</button>';	
				html += '</h2>';	
				html += '<div id="collapse-' + row.id + '" class="accordion-collapse collapse" aria-labelledby="heading-' + row.id + '" data-bs-parent="#accordion-' + row.id + '">';	
				html += '<div class="accordion-body">';	

				html += '<div class="form-group" style="display: none;">';
				html += '<textarea class="form-control" id="bstore~' + row.id + '" rows="5">' + JSON.stringify(row, null, 2) + '</textarea>';
				html += '</div>';

				html += '<table style="border: 0px solid #000; width: 100%;">';
				html += '<tr>';
				html += '<td width=20%" align="right"><strong>Name: (<a href="#" onclick="viewBlueprint(' + row.id + ');">View</a>)</strong></td>';
				html += '<td><input type="text" style="width: 90%;" onchange="updateBlueprintRowField(this);" class="form-control" id="name~' + row.id + '" placeholder="" value="' + row.name + '"></td>';
				html += '</tr>';				

				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Description:</strong></label></td>';
				html += '<td><textarea class="form-control" onchange="updateBlueprintRowField(this);" id="description~' + row.id + '" rows="3">' + row.description + '</textarea></td>';
				html += '</tr>';

				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Image:</strong></label></td>';
				html += '<td><input type="text" style="width: 100%;" class="form-control" onchange="updateBlueprintRowField(this);" id="image~' + row.id + '" placeholder="images/blueprints/image.jpeg" value="' + row.image + '"></td>';
				html += '</tr>';

				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Version:</strong></label></td>';
				html += '<td><input type="text" style="width: 20%;" class="form-control" onchange="updateBlueprintRowField(this);" id="version~' + row.id + '" placeholder="2021-09-11" value="' + row.version + '"></td>';
				html += '</tr>';				
				
				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Collection ID:</strong></label></td>';
				html += '<td><input type="text" style="width: 100%;" class="form-control" onchange="updateBlueprintRowField(this);" id="collection-id~' + row.id + '" placeholder="" value="' + row.collection_id + '"></td>';
				html += '</tr>';	
				
				html += '<tr>';
				html += '<td width=10%" align="right"><strong>State:</strong></label></td>';
				html += '<td><input type="text" style="width: 20%;" class="form-control" onchange="updateBlueprintRowField(this);" id="state~' + row.id + '" placeholder="" value="' + row.state + '"></td>';
				html += '</tr>';	
				
				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Maturity:</strong></label></td>';
				html += '<td><input type="text" style="width: 20%;" class="form-control" onchange="updateBlueprintRowField(this);" id="maturity~' + row.id + '" placeholder="" value="' + row.maturity + '"></td>';
				html += '</tr>';	
				
				html += '<tr>';
				html += '<td width=10%" align="right"><strong>Level:</strong></label></td>';
				html += '<td><input type="text" style="width: 20%;" class="form-control" onchange="updateBlueprintRowField(this);" id="level~' + row.id + '" placeholder="" value="' + row.level + '"></td>';
				html += '</tr>';	
				
				html += '</table>';

				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Tags</h3>';
				html += '</div>';					
				html += '<div class="col-auto">';
				html += '<input type="text" class="form-control" id="add-tag~' + row.id + '" placeholder="">';
				html += '</div>';
				html += '<div class="col-auto">';
				html += '<button type="button" onclick="addBlueprintTag(' + row.id + ');" class="btn btn-primary mb-3">Add Tag</button>';
				html += '</div>';
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="tag-list~' + row.id + '">';
				html += 'List Tags Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';				

				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Areas (<a href="#" onclick="openAddAreaModal(' + row.id + ');">Add</a>)</h3>';
				html += '</div>';									
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="area-list~' + row.id + '">';
				html += 'List Areas Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';
				html += '</form>';

				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Links (<a href="#" onclick="openAddLinkModal(' + row.id + ');">Add</a>)</h3>';
				html += '</div>';					
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="link-list~' + row.id + '">';
				html += 'List Links Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';

				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Videos (<a href="#" onclick="openAddVideoModal(' + row.id + ');">Add</a>)</h3>';
				html += '</div>';					
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="video-list~' + row.id + '">';
				html += 'List Videos Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';	
				
				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Questions (<a href="#" onclick="openAddQuestionModal(' + row.id + ');">Add</a>)</h3>';
				html += '</div>';					
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="question-list~' + row.id + '">';
				html += 'List Questions Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';	
				
				html += '<hr>';

				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Answers (<a href="#" onclick="openAddAnswerModal(' + row.id + '); return false;">Add</a>)</h3>';
				html += '</div>';					
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="answer-list~' + row.id + '">';
				html += 'List Answers Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';

				html += '<hr>';
				
				html += '<form class="row g-3">';
				html += '<div class="col-auto">';
				html += '<h3>Roles (<a href="#" onclick="openAddRoleModal(' + row.id + '); return false;">Add</a>)</h3>';
				html += '</div>';					
				html += '</form>';	
				html += '<div class="container">';
				html += '<div class="row">';			
				html += '<div class="container" id="role-list~' + row.id + '">';
				html += 'List Roles Here';
				html += '</div>';						
				html += '</div>';
				html += '</div>';				

				html += '<hr><center><input type="button" class="btn btn-danger" name="delete" value="DELETE BLUEPRINT" onclick="if (confirm(' + "'" + 'Are you sure you want to delete?' + "'" + ') == true) { deleteBlueprint(' + row.id + ') }" style=""></center>';				
				html += '</div>';	
				html += '</div>';	
				html += '</div>';								

				return html;
			}
		
			function listBlueprints(){

				var page = document.getElementById("page").value;
				var limit = document.getElementById("limit").value;
				var search = document.getElementById("search").value;
				var tags = document.getElementById("tags").value;
				var role = document.getElementById("role").value;
		
				const options = {
					method: 'get',
					headers: {
						"Content-Type": "application/json",
						"x-api-key": token,
					}
				};		
		
				fetch(blueprint_base_url + '/blueprints/?page=' + page + '&limit=' + limit + '&search=' + search + '&tags=' + tags + '&role=' + role,options)
					.then(function(response) {
						if (!response.ok) {
							console.log('Error with Status Code: ' + response.status);
							return;
						}
						response.json().then(function(data) {
							var rows = '';
							if(data){
								for (let i = 0; i < data.length; i++) {
									rows += blueprintRow(data[i],i);
								}							
							}
							document.getElementById("blueprintAccordian").innerHTML = rows;
							if(data){
								for (let i = 0; i < data.length; i++) {
									console.log("bview~" + data[i].id);
									document.getElementById("bview~" + data[i].id).value = blueprintHTMLRow(data[i],i);
								}								
							}							
						});
					})
					.catch(function(err) {
						console.log('Error: ' + err);
				});
				
			}

			if (window.addEventListener){
				window.addEventListener("load", listVideos, false);
				window.addEventListener("load", listLinks, false);
				window.addEventListener("load", listRoles, false);
				window.addEventListener("load", listQuestions, false);
				window.addEventListener("load", listAnswers, false);
				window.addEventListener("load", listElements, false);
				window.addEventListener("load", listBlueprints, false);
			}
			else if (window.attachEvent){
				window.attachEvent("onload", listVideos);
				window.attachEvent("onload", listLinks);
				window.attachEvent("onload", listRoles);
				window.attachEvent("onload", listQuestions);
				window.attachEvent("onload", listAnswers);
				window.attachEvent("onload", listElements);
				window.attachEvent("onload", listBlueprints);
			}
			else{
				window.onload = listVideos;		
				window.onload = listLinks;
				window.onload = listRoles;
				window.onload = listQuestions;
				window.onload = listAnswers;
				window.onload = listElements;	
				window.onload = listBlueprints;	
			}
	
		</script>		

	</div>
</div>

<div class="modal fade bd-example-modal-lg" id="addBlueprint" tabindex="-1" role="dialog" aria-labelledby="addBlueprintLabel" aria-hidden="true" style="width: 100%">
	<div class="modal-dialog modal-xl" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="addBlueprintLabel">New Blueprint</h5>
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddModal();">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">
		  <form>
			  <div class="form-group">
			  <label for="recipient-name" class="col-form-label">Name:</label>
			  <input type="text" class="form-control" id="add-name">
			  </div>					
			<div class="form-group">
			  <label for="message-text" class="col-form-label">Description:</label>
			  <textarea class="form-control" id="add-description"></textarea>
			</div>
			<div class="form-group">
			  <label for="recipient-name" class="col-form-label">Image:</label>
			  <input type="text" class="form-control" id="add-image">
			</div>				  
			<div class="form-group">
			  <label for="recipient-name" class="col-form-label">Version:</label>
			  <input type="text" class="form-control" id="add-version" style="width: 20%;">
			</div>				  					
			<div class="form-group">
			  <label for="recipient-name" class="col-form-label">State:</label>
			  <input type="text" class="form-control" id="add-state" style="width: 20%;">
			</div>					
			<div class="form-group">
			  <label for="recipient-name" class="col-form-label">Maturity:</label>
			  <input type="text" class="form-control" id="add-maturity" style="width: 20%;">
			</div>
			<div class="form-group">
			  <label for="recipient-name" class="col-form-label">Level:</label>
			  <input type="text" class="form-control" id="add-level" style="width: 20%;">
			</div>
		  </form>
		</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddModal();">Close</button>
		  <button type="button" class="btn btn-primary" onclick="addBlueprint();">Add</button>
		</div>
	  </div>
	</div>
  </div>
  
  <div class="modal fade bd-example-modal-lg" id="addArea" tabindex="-1" role="dialog" aria-labelledby="addAreaLabel" aria-hidden="true" style="width: 100%">
	<div class="modal-dialog modal-xl" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="addAreaLabel">New Area</h5>
		  <input type="hidden" id="add-area-blueprint-id" value="">
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddAreaModal();">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">
		  <form>
			<div class="form-group">
			  <label for="add-area-sort-order" class="col-form-label">Sort:</label>
			  <input type="text" class="form-control" id="add-area-sort-order" style="width: 100px; text-align:center;" value="1">
			</div>	
			<div class="form-group">
				<label for="add-area-label" class="col-form-label">Label:</label>
				<input type="text" class="form-control" id="add-area-label">
			</div>			  				
			<div class="form-group">
			  <label for="add-area-description" class="col-form-label">Description:</label>
			  <textarea class="form-control" id="add-area-description"></textarea>
			</div>
			<div class="form-group">
			  <label for="add-area-image" class="col-form-label">Image:</label>
			  <input type="text" class="form-control" id="add-area-image">
			</div>				  
		  </form>
		</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddAreaModal();">Close</button>
		  <button type="button" class="btn btn-primary" onclick="addArea();">Add</button>
		</div>
	  </div>
	</div>
  </div>

<style>
	.autocomplete {
	/*the container must be positioned relative:*/
	position: relative;
	display: inline-block;
	width: 100%;
	}
	input {
	border: 1px solid transparent;
	background-color: #f1f1f1;
	padding: 10px;
	font-size: 16px;
	}
	input[type=text] {
	background-color: #f1f1f1;
	width: 100%;
	}
	textarea {
	background-color: #f1f1f1;
	width: 100%;
	}	
	input[type=submit] {
	background-color: DodgerBlue;
	color: #fff;
	}
	.autocomplete-items {
	position: absolute;
	border: 1px solid #d4d4d4;
	border-bottom: none;
	border-top: none;
	z-index: 99;
	/*position the autocomplete items to be the same width as the container:*/
	top: 100%;
	left: 0;
	right: 0;
	}
	.autocomplete-items div {
	padding: 10px;
	cursor: pointer;
	background-color: #fff;
	border-bottom: 1px solid #d4d4d4;
	}
	.autocomplete-items div:hover {
	/*when hovering an item:*/
	background-color: #e9e9e9;
	}
	.autocomplete-active {
	/*when navigating through the items using the arrow keys:*/
	background-color: DodgerBlue !important;
	color: #ffffff;
	}	
</style>


  <textarea class="form-control" id="element-store" rows="5" style="display: none;"></textarea>
  <div class="modal fade bd-example-modal-lg" id="addElement" tabindex="-1" role="dialog" aria-labelledby="addElementLabel" aria-hidden="true" style="width: 100%">
	<div class="modal-dialog modal-xl" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="addElementLabel">New Element</h5>
		  <input type="hidden" id="add-element-blueprint-id" value="">
		  <input type="hidden" id="add-element-area-id" value="">
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddElementModal();">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">			
			<script>
				function addExistingElement()
					{

					console.log("Changing!");
					
					var elements = JSON.parse(document.getElementById("element-store").value);
					var name = document.getElementById("add-element-name").value;

					for (let i = 0; i < elements.length; i++) {
						//console.log(elements[i].name + ' == ' + name);
						if(elements[i].name == document.getElementById("add-element-name").value){
							console.log(elements[i]);
							document.getElementById("add-element-id").value = elements[i].id;
							document.getElementById("add-element-description").value = elements[i].description;							
						}
						}
					}
			</script>
			<form>
				<input type="hidden" class="form-control" id="add-element-id" value="">
				<div class="form-group">
					<label for="add-element-name" class="col-form-label">Name:</label>
					<div class="autocomplete">
						<input type="text" class="form-control" id="add-element-name">
					</div>
				</div>					
				<div class="form-group">
					<label for="add-element-description" class="col-form-label">Description:</label>
					<div>
						<textarea class="form-control" id="add-element-description"></textarea>
					</div>
				</div>			  
			</form>
		</div>
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddElementModal();">Close</button>
		  <button type="button" class="btn btn-primary" onclick="addElement();">Add</button>
		</div>
	  </div>
	</div>
  </div>

  <textarea class="form-control" id="link-store" rows="5" style="display: none;"></textarea>
<div class="modal fade bd-example-modal-lg" id="addLink" tabindex="-1" role="dialog" aria-labelledby="addLinkLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addLinkLabel">New Link</h5>
        <input type="hidden" id="add-link-blueprint-id" value="">
        <input type="hidden" id="add-link-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddLinkModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">			
          <script>
              function addExistingLink()
                  {

                  console.log("Changing!");
                  
                  var links = JSON.parse(document.getElementById("link-store").value);
                  var name = document.getElementById("add-link-name").value;

                  for (let i = 0; i < links.length; i++) {
                      //console.log(links[i].name + ' == ' + name);
                      if(links[i].name == document.getElementById("add-link-name").value){
                          console.log(links[i]);
                          document.getElementById("add-link-id").value = links[i].id;
                          document.getElementById("add-link-description").value = links[i].description;							
						  document.getElementById("add-link-url").value = links[i].url;	
                      }
                      }
                  }
          </script>
          <form>
              <input type="hidden" class="form-control" id="add-link-id" value="">
              <div class="form-group">
                  <label for="add-link-name" class="col-form-label">Name:</label>
                  <div class="autocomplete">
                      <input type="text" class="form-control" id="add-link-name">
                  </div>
              </div>					
              <div class="form-group">
                  <label for="add-link-description" class="col-form-description">Description:</label>
                  <div>
                      <textarea class="form-control" id="add-link-description"></textarea>
                  </div>
              </div>
              <div class="form-group">
				<label for="add-link-url" class="col-form-label">URL:</label>
				<div class="autocomplete">
					<input type="text" class="form-control" id="add-link-url">
				</div>
			</div>			  			  
          </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddLinkModal();">Close</button>
        <button type="button" class="btn btn-primary" onclick="addLink();">Add</button>
      </div>
    </div>
  </div>
</div>

<textarea class="form-control" id="video-store" rows="5" style="display: none;"></textarea>
<div class="modal fade bd-example-modal-lg" id="addVideo" tabindex="-1" role="dialog" aria-labelledby="addVideoLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addVideoLabel">New Video</h5>
        <input type="hidden" id="add-video-blueprint-id" value="">
        <input type="hidden" id="add-video-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddVideoModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">			
          <script>
              function addExistingVideo()
                  {

                  console.log("Changing!");
                  
                  var videos = JSON.parse(document.getElementById("video-store").value);
                  var name = document.getElementById("add-video-name").value;

                  for (let i = 0; i < videos.length; i++) {
                      //console.log(videos[i].name + ' == ' + name);
                      if(videos[i].name == document.getElementById("add-video-name").value){
                          console.log(videos[i]);
                          document.getElementById("add-video-id").value = videos[i].id;
                          document.getElementById("add-video-description").value = videos[i].description;							
                      }
                      }
                  }
          </script>
          <form>
              <input type="hidden" class="form-control" id="add-video-id" value="">
              <div class="form-group">
                  <label for="add-video-name" class="col-form-label">Name:</label>
                  <div class="autocomplete">
                      <input type="text" class="form-control" id="add-video-name">
                  </div>
              </div>					
              <div class="form-group">
                  <label for="add-video-description" class="col-form-description">Description:</label>
                  <div>
                      <textarea class="form-control" id="add-video-description"></textarea>
                  </div>
              </div>			  
          </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddVideoModal();">Close</button>
        <button type="button" class="btn btn-primary" onclick="addVideo();">Add</button>
      </div>
    </div>
  </div>
</div>

<textarea class="form-control" id="question-store" rows="5" style="display: none;"></textarea>
<div class="modal fade bd-example-modal-lg" id="addQuestion" tabindex="-1" role="dialog" aria-labelledby="addQuestionLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addQuestionLabel">New Question</h5>
        <input type="hidden" id="add-question-blueprint-id" value="">
        <input type="hidden" id="add-question-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddQuestionModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">			
          <script>
              function addExistingQuestion()
                  {

                  console.log("Changing!");
                  
                  var questions = JSON.parse(document.getElementById("question-store").value);
                  var name = document.getElementById("add-question-name").value;

                  for (let i = 0; i < questions.length; i++) {
                      //console.log(questions[i].name + ' == ' + name);
                      if(questions[i].name == document.getElementById("add-question-name").value){
                          console.log(questions[i]);
                          document.getElementById("add-question-id").value = questions[i].id;
                          document.getElementById("add-question-description").value = questions[i].description;							
                      }
                      }
                  }
          </script>
          <form>
              <input type="hidden" class="form-control" id="add-question-id" value="">
              <div class="form-group">
                  <label for="add-question-name" class="col-form-label">Name:</label>
                  <div class="autocomplete">
                      <input type="text" class="form-control" id="add-question-name">
                  </div>
              </div>					
              <div class="form-group">
                  <label for="add-question-description" class="col-form-label">Description:</label>
                  <div>
                      <textarea class="form-control" id="add-question-description"></textarea>
                  </div>
              </div>			  
          </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddQuestionModal();">Close</button>
        <button type="button" class="btn btn-primary" onclick="addQuestion();">Add</button>
      </div>
    </div>
  </div>
</div>

<textarea class="form-control" id="answer-store" rows="5" style="display: none;"></textarea>
<div class="modal fade bd-example-modal-lg" id="addAnswer" tabindex="-1" role="dialog" aria-labelledby="addAnswerLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addAnswerLabel">New Answer</h5>
        <input type="hidden" id="add-answer-blueprint-id" value="">
        <input type="hidden" id="add-answer-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddAnswerModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">			
          <script>
              function addExistingAnswer()
                  {

                  console.log("Changing!");
                  
                  var answers = JSON.parse(document.getElementById("answer-store").value);
                  var name = document.getElementById("add-answer-name").value;

                  for (let i = 0; i < answers.length; i++) {
                      //console.log(answers[i].name + ' == ' + name);
                      if(answers[i].name == document.getElementById("add-answer-name").value){
                          console.log(answers[i]);
                          document.getElementById("add-answer-id").value = answers[i].id;
                          document.getElementById("add-answer-description").value = answers[i].description;							
                      }
                      }
                  }
          </script>
          <form>
              <input type="hidden" class="form-control" id="add-answer-id" value="">
              <div class="form-group">
                  <label for="add-answer-name" class="col-form-name">Name:</label>
                  <div class="autocomplete">
                      <input type="text" class="form-control" id="add-answer-name">
                  </div>
              </div>					
              <div class="form-group">
                  <label for="add-answer-description" class="col-form-label">Description:</label>
                  <div>
                      <textarea class="form-control" id="add-answer-description"></textarea>
                  </div>
              </div>			  
          </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddAnswerModal();">Close</button>
        <button type="button" class="btn btn-primary" onclick="addAnswer();">Add</button>
      </div>
    </div>
  </div>
</div>

<textarea class="form-control" id="role-store" rows="5" style="display: none;"></textarea>
<div class="modal fade bd-example-modal-lg" id="addRole" tabindex="-1" role="dialog" aria-labelledby="addRoleLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addRoleLabel">New Role</h5>
        <input type="hidden" id="add-role-blueprint-id" value="">
        <input type="hidden" id="add-role-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeAddRoleModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">			
          <script>
              function addExistingRole()
                  {

                  console.log("Changing!");
                  
                  var roles = JSON.parse(document.getElementById("role-store").value);
                  var name = document.getElementById("add-role-name").value;

                  for (let i = 0; i < roles.length; i++) {
                      //console.log(roles[i].name + ' == ' + name);
                      if(roles[i].name == document.getElementById("add-role-name").value){
                          console.log(roles[i]);
                          document.getElementById("add-role-id").value = roles[i].id;
                          document.getElementById("add-role-description").value = roles[i].description;							
                      }
                      }
                  }
          </script>
          <form>
              <input type="hidden" class="form-control" id="add-role-id" value="">
              <div class="form-group">
                  <label for="add-role-name" class="col-form-name">Name:</label>
                  <div class="autocomplete">
                      <input type="text" class="form-control" id="add-role-name">
                  </div>
              </div>					
              <div class="form-group">
                  <label for="add-role-description" class="col-form-label">Description:</label>
                  <div>
                      <textarea class="form-control" id="add-role-description"></textarea>
                  </div>
              </div>			  
          </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeAddRoleModal();">Close</button>
        <button type="button" class="btn btn-primary" onclick="addRole();">Add</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade bd-example-modal-lg" id="viewBlueprint" tabindex="-1" role="dialog" aria-labelledby="viewBlueprintLabel" aria-hidden="true" style="width: 100%">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addRoleLabel">Blueprint View</h5>
        <input type="hidden" id="add-role-blueprint-id" value="">
        <input type="hidden" id="add-role-area-id" value="">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="closeViewBlueprintModal();">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" id="viewBlueprintBody">			
		HELLO!!!
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="closeViewBlueprintModal();">Close</button>
      </div>
    </div>
  </div>
</div>